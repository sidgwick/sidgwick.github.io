---
layout: post
title: Yii2学习笔记 -- 构建一个自定义的应用
excerpt:
date:   2015-12-30 14:28:04
categories: php yii2 learn
---

这次, 我们来实现一个小小的web应用. 我们将用绝对符合软件工程的方法来实现.

## 设计阶段

### 我们的任务

假想我们是一个提供某种服务的小商户. 我们的客户数量很多, 所以, 用纸张来存储客户
信息会显得有点笨重. 所以, 我们需要一种能接受给定信息, 反馈出客户全部信息的自动
查询方法.

### 领域模型设计

我们使用`customer`一词来表示客户. 一个客户的信息应该包含名字, 电话, 地址, 电邮
等, 我们对客户收费按照合同里面规定的服务小时数来计算. 我们在第一个迭代里面将会
包含这些内容.

我们假设是每个客户就是一个单独的人. 这样我们就不用处理公司这种可能有多个联系人
的情况. 如果我们把客户的名字分解成姓,名,昵称...那将会是一个颇为复杂的结构. 索性
我们就不考虑这么多, 反正对我们来说, 名字就是一个标示符而已. 那么, 我们就把它设置
成一行文本算逑, 怎么写也随你便. 细想起来, 地址也够复杂, 但是我们不能简单地用文
本代替, 因为我们需要对地址做以下处理:

- 计算一些统计信息, 比如某个城市有多少用户.
- 根据不同的文化类型, 生成对应的邮政地址

所以, 我们决定把地址定义成如下的数据结构:

- 用途(比如工作地址, 邮寄地址, 家庭地址等)
- 国家
- 州/省
- 市
- 街道
- XX大楼
- xx办公室/室
- 收件人
- 邮编

我们要注意到, 一个地址可以是一个公寓, 一个邮箱, 一个办公室, 或者是一个组织的一
名雇员. 当然一个人也可以有多个地址.

同理, 由于一个人可以有多个号码, 所以电话设计成下面的结构:

- 用途
- 号码

除了名字, 地址, 电话之外. 很明显我们还需要一个文本字段来表述客户, 我们把这个叫做
备注(notes). 嗯, 记下来用户的生日也很酷, 还有电邮. 顺便说下, 电邮也可以有多个

先停下, 我们根据上面的讨论, 绘制了如下的ER图:

![图没有画](/data/php/yii2/learn/cp02/er.dot.svg)
